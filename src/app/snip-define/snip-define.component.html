
<div class="snip-define-container">
  <div class="snip-define-nav">
    <a [routerLink]="['/']" class="button fancy-button">
      ← Search Podcasts
    </a>
    <a [routerLink]="['/snips']" class="button fancy-button">
      My Snips
    </a>
  </div>

  <div class="episode-header">
    <h2 class="episode-title">{{episodeData.trackName || 'Unknown Episode'}}</h2>
    <p class="podcast-name">{{episodeData.collectionName || 'Unknown Podcast'}}</p>
  </div>

  @if (episodeData.episodeUrl) {
    <div class="audio-player-section">
      <audio id="player" controls class="audio-player">
        <source id="player-source" [src]="episodeData.episodeUrl" type="audio/mpeg"/>
        Your browser does not support the audio element.
      </audio>
    </div>
  }

  <div class="time-inputs-section">
    <h3>Define Snip Times</h3>

    <div class="time-input-group">
      <div class="time-input-field">
        <label for="start-time">Start Time</label>
        <input
          id="start-time"
          type="text"
          [(ngModel)]="startTime"
          (ngModelChange)="onStartTimeChange()"
          placeholder="MM:SS or HH:MM:SS"
          class="time-input"
          />
      </div>

      <div class="time-input-field">
        <label for="end-time">End Time</label>
        <input
          id="end-time"
          type="text"
          [(ngModel)]="endTime"
          (ngModelChange)="onEndTimeChange()"
          placeholder="MM:SS or HH:MM:SS"
          class="time-input"
          />
      </div>
    </div>

    <div class="save-button-container">
      <button
        type="button"
        [class]="'button save-button' + (isSaved ? ' saved' : '')"
        (click)="handleSave()"
        [disabled]="!startTime && !endTime"
        >
        {{isSaved ? 'Saved ✓' : 'Save Snip Times'}}
      </button>
    </div>

    @if (startTime || endTime) {
      <div class="snip-summary">
        <h4>Current Snip</h4>
        <p>
          <strong>Duration:</strong> {{startTime || '--:--'}} - {{endTime || '--:--'}}
          @if (getDuration() !== null) {
            <span class="duration-calc">
              ({{getDuration()}}s)
            </span>
          }
        </p>
      </div>
    }
  </div>

  <div class="debug-section">
    <details>
      <summary>Debug Info</summary>
      <pre class="debug-data">{{episodeData | json}}</pre>
    </details>
  </div>
</div>